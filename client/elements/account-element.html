<html>
<head>

<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/polymer/polymer.html">

</head>
<body>

<dom-module id="account-element">
  <template>
    <paper-dropdown-menu id="dropdownMenu" label="Label Here" >
            <paper-menu id="menu" class="dropdown-content" selected="0">
                <paper-item id="option1">Option 1</paper-item>
                <paper-item id="option2">Option 2</paper-item>
            </paper-menu>
    </paper-dropdown-menu>
    <iron-ajax auto url="http://localhost:9999/api/getAccounts" last-response="{{resp}}" method="GET"></iron-ajax>
    <template is="dom-repeat" items="{{resp}}" as="account">
      <div>
        <ul><b><span>{{account.firstName}}</span> <span>{{account.lastName}}</span></b></ul>
          <template id="transactionTable"
                    is="dom-repeat"
                    items="{{account.transactions}}"
                    as="transaction"
                    as-index="index"
                    filter="_isWholeFoods"
                    sort="_compare">
            <p><span>{{index}}</span>, <span>{{transaction.amount}}</span>, <span>{{transaction.location}}</span></p>
          </template>
      </div>
    </template>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'account-element',
    properties: {
      resp: {
        type: Object
      }
    },
    sortoption: 'location',
    updateTransactionSortOption: function() {
      console.log('hehehehehe');
    },
    _isWholeFoods: function(transaction) {
      // console.log('the transaction location is ' + transaction.location);
      console.log('is whole foods??');
      if (transaction.location == 'Whole Foods') {
        return true;
      }
      return true;
    },
    _compare: function(a,b) {
      var key = 'location';
      var aobj = a[key];
      var bobj = b[key];
      if (aobj < bobj)
        return -1;
      if (aobj > bobj)
          return 1;
      return 0;
    }
  });
</script>
